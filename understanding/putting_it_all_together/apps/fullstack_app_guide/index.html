
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.llamaindex.ai/en/stable/understanding/putting_it_all_together/apps/fullstack_app_guide/">
      
      
        <link rel="prev" href="../../">
      
      
        <link rel="next" href="../fullstack_with_delphic/">
      
      
      <link rel="icon" href="../../../../_static/assets/LlamaLogoBrowserTab.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>ä½¿ç”¨ LLamaIndex æ„å»ºå…¨æ ˆ Web åº”ç”¨æŒ‡å— - LlamaIndex</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../css/style.css">
    
      <link rel="stylesheet" href="../../../../css/algolia.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-BYVB1ZVE6J"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-BYVB1ZVE6J",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-BYVB1ZVE6J",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#llamaindex-web" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="LlamaIndex" class="md-header__button md-logo" aria-label="LlamaIndex" data-md-component="logo">
      
  <img src="../../../../_static/assets/LlamaSquareBlack.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LlamaIndex
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ä½¿ç”¨ LLamaIndex æ„å»ºå…¨æ ˆ Web åº”ç”¨æŒ‡å—
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="purple"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      

<!-- Search interface -->
<div id="docsearch"></div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../.." class="md-tabs__link">
          
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../" class="md-tabs__link">
          
  
    
  
  Learn

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../use_cases/" class="md-tabs__link">
          
  
    
  
  Use Cases

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../examples/" class="md-tabs__link">
          
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../module_guides/" class="md-tabs__link">
          
  
    
  
  Component Guides

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../optimizing/production_rag/" class="md-tabs__link">
          
  
    
  
  Advanced Topics

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../api_reference/" class="md-tabs__link">
          
  
    
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../community/integrations/" class="md-tabs__link">
          
  
    
  
  Open-Source Community

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="https://docs.cloud.llamaindex.ai/" class="md-tabs__link">
        
  
    
  
  LlamaCloud

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="LlamaIndex" class="md-nav__button md-logo" aria-label="LlamaIndex" data-md-component="logo">
      
  <img src="../../../../_static/assets/LlamaSquareBlack.svg" alt="logo">

    </a>
    LlamaIndex
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../.." class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Home
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Learn
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Learn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../using_llms/using_llms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using LLMs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../agent/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Building agents
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../workflows/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Building Workflows
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../rag/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Building a RAG pipeline
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../extraction/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Structured Data Extraction
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tracing_and_debugging/tracing_and_debugging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tracing and Debugging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../evaluating/evaluating/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Evaluating
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Putting it all Together
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            Putting it all Together
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
          
        
      
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Full-stack web application
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_9_2" id="__nav_2_9_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_9_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_9_2">
            <span class="md-nav__icon md-icon"></span>
            Full-stack web application
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    ä½¿ç”¨ LLamaIndex æ„å»ºå…¨æ ˆ Web åº”ç”¨æŒ‡å—
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ LLamaIndex æ„å»ºå…¨æ ˆ Web åº”ç”¨æŒ‡å—
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#flask" class="md-nav__link">
    <span class="md-ellipsis">
      Flask åç«¯
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Flask åç«¯">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flask-" class="md-nav__link">
    <span class="md-ellipsis">
      åŸºç¡€ Flask - å¤„ç†ç”¨æˆ·ç´¢å¼•æŸ¥è¯¢
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flask-_1" class="md-nav__link">
    <span class="md-ellipsis">
      é«˜çº§ Flask - å¤„ç†ç”¨æˆ·æ–‡æ¡£ä¸Šä¼ 
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#react" class="md-nav__link">
    <span class="md-ellipsis">
      React å‰ç«¯
    </span>
  </a>
  
    <nav class="md-nav" aria-label="React å‰ç«¯">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fetchdocumentstsx" class="md-nav__link">
    <span class="md-ellipsis">
      fetchDocuments.tsx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#queryindextsx" class="md-nav__link">
    <span class="md-ellipsis">
      queryIndex.tsx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insertdocumenttsx" class="md-nav__link">
    <span class="md-ellipsis">
      insertDocument.tsx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      å…¶ä»–å‰ç«¯äº®ç‚¹
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      ç»“è¯­
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fullstack_with_delphic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨ Delphic æ„å»ºå…¨æ ˆ LlamaIndex Web åº”ç”¨çš„æŒ‡å—
  </span>
  

      </a>
    </li>
  

              
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../q_and_a/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Q&A Patterns
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../chatbots/building_a_chatbot/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Chatbots
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../structured_data/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Structured data
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../use_cases/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Use Cases
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../examples/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../module_guides/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Component Guides
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../optimizing/production_rag/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Advanced Topics
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../api_reference/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../community/integrations/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Open-Source Community
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.cloud.llamaindex.ai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LlamaCloud
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#flask" class="md-nav__link">
    <span class="md-ellipsis">
      Flask åç«¯
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Flask åç«¯">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flask-" class="md-nav__link">
    <span class="md-ellipsis">
      åŸºç¡€ Flask - å¤„ç†ç”¨æˆ·ç´¢å¼•æŸ¥è¯¢
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flask-_1" class="md-nav__link">
    <span class="md-ellipsis">
      é«˜çº§ Flask - å¤„ç†ç”¨æˆ·æ–‡æ¡£ä¸Šä¼ 
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#react" class="md-nav__link">
    <span class="md-ellipsis">
      React å‰ç«¯
    </span>
  </a>
  
    <nav class="md-nav" aria-label="React å‰ç«¯">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fetchdocumentstsx" class="md-nav__link">
    <span class="md-ellipsis">
      fetchDocuments.tsx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#queryindextsx" class="md-nav__link">
    <span class="md-ellipsis">
      queryIndex.tsx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#insertdocumenttsx" class="md-nav__link">
    <span class="md-ellipsis">
      insertDocument.tsx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      å…¶ä»–å‰ç«¯äº®ç‚¹
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      ç»“è¯­
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="llamaindex-web">ä½¿ç”¨ LLamaIndex æ„å»ºå…¨æ ˆ Web åº”ç”¨æŒ‡å—<a class="headerlink" href="#llamaindex-web" title="Permanent link">#</a></h1>
<p>LlamaIndex æ˜¯ä¸€ä¸ª Python åº“ï¼Œè¿™æ„å‘³ç€å°†å…¶ä¸å…¨æ ˆ Web åº”ç”¨é›†æˆä¼šä¸æ‚¨ä¹ æƒ¯çš„æ–¹å¼ç•¥æœ‰ä¸åŒã€‚</p>
<p>æœ¬æŒ‡å—æ—¨åœ¨é€æ­¥ä»‹ç»åˆ›å»ºä¸€ä¸ªåŸºç¡€ Python API æœåŠ¡çš„æ­¥éª¤ï¼Œä»¥åŠå¦‚ä½•ä¸ TypeScript+React å‰ç«¯è¿›è¡Œäº¤äº’ã€‚</p>
<p>æ‰€æœ‰ä»£ç ç¤ºä¾‹å‡å¯ä» <a href="https://github.com/logan-markewich/llama_index_starter_pack/tree/main/flask_react">llama_index_starter_pack</a> çš„ flask_react æ–‡ä»¶å¤¹ä¸­è·å–ã€‚</p>
<p>æœ¬æŒ‡å—ä½¿ç”¨çš„ä¸»è¦æŠ€æœ¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>python3.11</li>
<li>llama_index</li>
<li>flask</li>
<li>typescript</li>
<li>react</li>
</ul>
<h2 id="flask">Flask åç«¯<a class="headerlink" href="#flask" title="Permanent link">#</a></h2>
<p>åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <a href="https://flask.palletsprojects.com/en/2.2.x/">Flask</a> API æœåŠ¡å™¨ä¸å‰ç«¯ä»£ç é€šä¿¡ã€‚å¦‚æœæ‚¨æ„¿æ„ï¼Œä¹Ÿå¯ä»¥è½»æ¾åœ°å°†å…¶è½¬æ¢ä¸º <a href="https://fastapi.tiangolo.com/">FastAPI</a> æœåŠ¡å™¨æˆ–ä»»ä½•å…¶ä»–æ‚¨é€‰æ‹©çš„ Python æœåŠ¡å™¨åº“ã€‚</p>
<p>ä½¿ç”¨ Flask è®¾ç½®æœåŠ¡å™¨éå¸¸ç®€å•ã€‚å¯¼å…¥åŒ…ã€åˆ›å»ºåº”ç”¨å¯¹è±¡ï¼Œç„¶ååˆ›å»ºç«¯ç‚¹ã€‚é¦–å…ˆè®©æˆ‘ä»¬ä¸ºæœåŠ¡å™¨åˆ›å»ºä¸€ä¸ªåŸºç¡€æ¡†æ¶ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;Hello World!&quot;</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5601</span><span class="p">)</span>
</code></pre></div>
<p><em>flask_demo.py</em></p>
<p>å¦‚æœè¿è¡Œæ­¤æ–‡ä»¶ï¼ˆ<code>python flask_demo.py</code>ï¼‰ï¼Œå®ƒå°†åœ¨ 5601 ç«¯å£å¯åŠ¨æœåŠ¡å™¨ã€‚è®¿é—® <code>http://localhost:5601/</code>ï¼Œæ‚¨å°†åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ° "Hello World!" æ–‡æœ¬ã€‚å¾ˆå¥½ï¼</p>
<p>ä¸‹ä¸€æ­¥æ˜¯å†³å®šè¦åœ¨æœåŠ¡å™¨ä¸­åŒ…å«å“ªäº›åŠŸèƒ½ï¼Œå¹¶å¼€å§‹ä½¿ç”¨ LlamaIndexã€‚</p>
<p>ä¸ºäº†ä¿æŒç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥æä¾›çš„æœ€åŸºæœ¬æ“ä½œæ˜¯æŸ¥è¯¢ç°æœ‰ç´¢å¼•ã€‚ä½¿ç”¨ LlamaIndex ä¸­çš„ <a href="https://github.com/jerryjliu/llama_index/blob/main/examples/paul_graham_essay/data/paul_graham_essay.txt">paul graham essay</a>ï¼Œåˆ›å»ºä¸€ä¸ª documents æ–‡ä»¶å¤¹å¹¶ä¸‹è½½+æ”¾ç½®è¯¥æ–‡ç« æ–‡æœ¬æ–‡ä»¶åˆ°å…¶ä¸­ã€‚</p>
<h3 id="flask-">åŸºç¡€ Flask - å¤„ç†ç”¨æˆ·ç´¢å¼•æŸ¥è¯¢<a class="headerlink" href="#flask-" title="Permanent link">#</a></h3>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç¼–å†™ä¸€äº›ä»£ç æ¥åˆå§‹åŒ–ç´¢å¼•ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">llama_index.core</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SimpleDirectoryReader</span><span class="p">,</span>
    <span class="n">VectorStoreIndex</span><span class="p">,</span>
    <span class="n">StorageContext</span><span class="p">,</span>
    <span class="n">load_index_from_storage</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># æ³¨æ„ï¼šä»…ç”¨äºæœ¬åœ°æµ‹è¯•ï¼Œè¯·å‹¿éƒ¨ç½²æ—¶ç¡¬ç¼–ç å¯†é’¥</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OPENAI_API_KEY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;your key here&quot;</span>

<span class="n">index</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">def</span> <span class="nf">initialize_index</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">index</span>
    <span class="n">storage_context</span> <span class="o">=</span> <span class="n">StorageContext</span><span class="o">.</span><span class="n">from_defaults</span><span class="p">()</span>
    <span class="n">index_dir</span> <span class="o">=</span> <span class="s2">&quot;./.index&quot;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">index_dir</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">load_index_from_storage</span><span class="p">(</span><span class="n">storage_context</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">documents</span> <span class="o">=</span> <span class="n">SimpleDirectoryReader</span><span class="p">(</span><span class="s2">&quot;./documents&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">VectorStoreIndex</span><span class="o">.</span><span class="n">from_documents</span><span class="p">(</span>
            <span class="n">documents</span><span class="p">,</span> <span class="n">storage_context</span><span class="o">=</span><span class="n">storage_context</span>
        <span class="p">)</span>
        <span class="n">storage_context</span><span class="o">.</span><span class="n">persist</span><span class="p">(</span><span class="n">index_dir</span><span class="p">)</span>
</code></pre></div>
<p>æ­¤å‡½æ•°å°†åˆå§‹åŒ–æˆ‘ä»¬çš„ç´¢å¼•ã€‚å¦‚æœåœ¨ <code>main</code> å‡½æ•°ä¸­å¯åŠ¨ flask æœåŠ¡å™¨ä¹‹å‰è°ƒç”¨æ­¤å‡½æ•°ï¼Œæˆ‘ä»¬çš„ç´¢å¼•å°†å‡†å¤‡å¥½å¤„ç†ç”¨æˆ·æŸ¥è¯¢ï¼</p>
<p>æˆ‘ä»¬çš„æŸ¥è¯¢ç«¯ç‚¹å°†æ¥å—å¸¦æœ‰æŸ¥è¯¢æ–‡æœ¬ä½œä¸ºå‚æ•°çš„ <code>GET</code> è¯·æ±‚ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´çš„ç«¯ç‚¹å‡½æ•°ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/query&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">query_index</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">index</span>
    <span class="n">query_text</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">query_text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="s2">&quot;No text found, please include a ?text=blah parameter in the URL&quot;</span><span class="p">,</span>
            <span class="mi">400</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">query_engine</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">as_query_engine</span><span class="p">()</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">query_engine</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query_text</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="p">),</span> <span class="mi">200</span>
</code></pre></div>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬ä¸ºæœåŠ¡å™¨å¼•å…¥äº†å‡ ä¸ªæ–°æ¦‚å¿µï¼š</p>
<ul>
<li>ç”±å‡½æ•°è£…é¥°å™¨å®šä¹‰çš„æ–° <code>/query</code> ç«¯ç‚¹</li>
<li>ä» flask å¯¼å…¥çš„æ–° <code>request</code>ï¼Œç”¨äºä»è¯·æ±‚ä¸­è·å–å‚æ•°</li>
<li>å¦‚æœç¼ºå°‘ <code>text</code> å‚æ•°ï¼Œåˆ™è¿”å›é”™è¯¯æ¶ˆæ¯å’Œé€‚å½“çš„ HTML å“åº”ä»£ç </li>
<li>å¦åˆ™ï¼Œæˆ‘ä»¬æŸ¥è¯¢ç´¢å¼•ï¼Œå¹¶å°†å“åº”ä½œä¸ºå­—ç¬¦ä¸²è¿”å›</li>
</ul>
<p>æ‚¨å¯ä»¥åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•çš„å®Œæ•´æŸ¥è¯¢ç¤ºä¾‹å¦‚ä¸‹ï¼š<code>http://localhost:5601/query?text=what did the author do growing up</code>ï¼ˆæŒ‰ä¸‹å›è½¦åï¼Œæµè§ˆå™¨ä¼šå°†ç©ºæ ¼è½¬æ¢ä¸º "%20" å­—ç¬¦ï¼‰ã€‚</p>
<p>çœ‹èµ·æ¥ç›¸å½“ä¸é”™ï¼æˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸€ä¸ªåŠŸèƒ½æ€§çš„ APIã€‚ä½¿ç”¨æ‚¨è‡ªå·±çš„æ–‡æ¡£ï¼Œå¯ä»¥è½»æ¾ä¸ºä»»ä½•åº”ç”¨ç¨‹åºæä¾›è°ƒç”¨ flask API å¹¶è·å–æŸ¥è¯¢ç­”æ¡ˆçš„æ¥å£ã€‚</p>
<h3 id="flask-_1">é«˜çº§ Flask - å¤„ç†ç”¨æˆ·æ–‡æ¡£ä¸Šä¼ <a class="headerlink" href="#flask-_1" title="Permanent link">#</a></h3>
<p>ç›®å‰çœ‹èµ·æ¥ç›¸å½“ä¸é”™ï¼Œä½†æˆ‘ä»¬å¦‚ä½•æ›´è¿›ä¸€æ­¥å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬æƒ³å…è®¸ç”¨æˆ·é€šè¿‡ä¸Šä¼ è‡ªå·±çš„æ–‡æ¡£æ¥æ„å»ºç´¢å¼•å‘¢ï¼Ÿåˆ«æ‹…å¿ƒï¼ŒFlask éƒ½èƒ½æå®š ğŸ’ªã€‚</p>
<p>è¦è®©ç”¨æˆ·ä¸Šä¼ æ–‡æ¡£ï¼Œæˆ‘ä»¬éœ€è¦é‡‡å–ä¸€äº›é¢å¤–çš„é¢„é˜²æªæ–½ã€‚ä¸æŸ¥è¯¢ç°æœ‰ç´¢å¼•ä¸åŒï¼Œæ­¤æ—¶ç´¢å¼•å°†å˜ä¸º<strong>å¯å˜</strong>çš„ã€‚å¦‚æœæœ‰å¤šä¸ªç”¨æˆ·åŒæ—¶å‘åŒä¸€ç´¢å¼•æ·»åŠ å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘å¦‚ä½•å¤„ç†å¹¶å‘é—®é¢˜ã€‚æˆ‘ä»¬çš„ Flask æœåŠ¡å™¨æ˜¯å¤šçº¿ç¨‹çš„ï¼Œè¿™æ„å‘³ç€å¤šä¸ªç”¨æˆ·å¯ä»¥åŒæ—¶å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚</p>
<p>ä¸€ä¸ªå¯èƒ½çš„è§£å†³æ–¹æ¡ˆæ˜¯ä¸ºæ¯ä¸ªç”¨æˆ·æˆ–ç¾¤ç»„åˆ›å»ºç‹¬ç«‹çš„ç´¢å¼•ï¼Œå¹¶é€šè¿‡ S3 å­˜å‚¨å’Œè·å–æ•°æ®ã€‚ä½†åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†å‡è®¾æ‰€æœ‰ç”¨æˆ·éƒ½åœ¨ä¸ä¸€ä¸ªæœ¬åœ°å­˜å‚¨çš„ç´¢å¼•è¿›è¡Œäº¤äº’ã€‚</p>
<p>ä¸ºäº†å¤„ç†å¹¶å‘ä¸Šä¼ å¹¶ç¡®ä¿æŒ‰é¡ºåºæ’å…¥ç´¢å¼•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Python çš„ <code>BaseManager</code> åŒ…ï¼Œé€šè¿‡ç‹¬ç«‹çš„æœåŠ¡å™¨å’Œé”æœºåˆ¶æ¥æä¾›å¯¹ç´¢å¼•çš„é¡ºåºè®¿é—®ã€‚å¬èµ·æ¥æœ‰ç‚¹å“äººï¼Œä½†å…¶å®å¹¶ä¸å¤æ‚ï¼æˆ‘ä»¬åªéœ€å°†æ‰€æœ‰ç´¢å¼•æ“ä½œï¼ˆåˆå§‹åŒ–ã€æŸ¥è¯¢ã€æ’å…¥ï¼‰ç§»åˆ° <code>BaseManager</code> çš„ "index_server" ä¸­ï¼Œç„¶åé€šè¿‡ Flask æœåŠ¡å™¨è°ƒç”¨ã€‚</p>
<p>ä»¥ä¸‹æ˜¯è¿ç§»ä»£ç å <code>index_server.py</code> çš„åŸºæœ¬ç¤ºä¾‹ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Lock</span>
<span class="kn">from</span> <span class="nn">multiprocessing.managers</span> <span class="kn">import</span> <span class="n">BaseManager</span>
<span class="kn">from</span> <span class="nn">llama_index.core</span> <span class="kn">import</span> <span class="n">SimpleDirectoryReader</span><span class="p">,</span> <span class="n">VectorStoreIndex</span><span class="p">,</span> <span class="n">Document</span>

<span class="c1"># æ³¨æ„ï¼šä»…é™æœ¬åœ°æµ‹è¯•ï¼Œåˆ‡å‹¿åœ¨éƒ¨ç½²æ—¶ç¡¬ç¼–ç å¯†é’¥</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OPENAI_API_KEY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;your key here&quot;</span>

<span class="n">index</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">initialize_index</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">index</span>

    <span class="k">with</span> <span class="n">lock</span><span class="p">:</span>
        <span class="c1"># å’Œä¹‹å‰ä¸€æ ·...</span>
        <span class="k">pass</span>


<span class="k">def</span> <span class="nf">query_index</span><span class="p">(</span><span class="n">query_text</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">index</span>
    <span class="n">query_engine</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">as_query_engine</span><span class="p">()</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">query_engine</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query_text</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># åˆå§‹åŒ–å…¨å±€ç´¢å¼•</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;initializing index...&quot;</span><span class="p">)</span>
    <span class="n">initialize_index</span><span class="p">()</span>

    <span class="c1"># è®¾ç½®æœåŠ¡å™¨</span>
    <span class="c1"># æ³¨æ„ï¼šå»ºè®®é‡‡ç”¨æ›´å®‰å…¨çš„æ–¹å¼å¤„ç†å¯†ç </span>
    <span class="n">manager</span> <span class="o">=</span> <span class="n">BaseManager</span><span class="p">((</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">5602</span><span class="p">),</span> <span class="sa">b</span><span class="s2">&quot;password&quot;</span><span class="p">)</span>
    <span class="n">manager</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;query_index&quot;</span><span class="p">,</span> <span class="n">query_index</span><span class="p">)</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">get_server</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;starting server...&quot;</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</code></pre></div>
<p><em>index_server.py</em></p>
<p>æˆ‘ä»¬è¿ç§»äº†å‡½æ•°ï¼Œå¼•å…¥äº†ç¡®ä¿é¡ºåºè®¿é—®å…¨å±€ç´¢å¼•çš„ <code>Lock</code> å¯¹è±¡ï¼Œåœ¨æœåŠ¡å™¨ä¸­æ³¨å†Œäº†å‡½æ•°ï¼Œå¹¶åœ¨ç«¯å£ 5602 ä¸Šä»¥å¯†ç  <code>password</code> å¯åŠ¨äº†æœåŠ¡å™¨ã€‚</p>
<p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼è°ƒæ•´ Flask ä»£ç ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">multiprocessing.managers</span> <span class="kn">import</span> <span class="n">BaseManager</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span>

<span class="c1"># åˆå§‹åŒ–ç®¡ç†å™¨è¿æ¥</span>
<span class="c1"># æ³¨æ„ï¼šå»ºè®®é‡‡ç”¨æ›´å®‰å…¨çš„æ–¹å¼å¤„ç†å¯†ç </span>
<span class="n">manager</span> <span class="o">=</span> <span class="n">BaseManager</span><span class="p">((</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">5602</span><span class="p">),</span> <span class="sa">b</span><span class="s2">&quot;password&quot;</span><span class="p">)</span>
<span class="n">manager</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;query_index&quot;</span><span class="p">)</span>
<span class="n">manager</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/query&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">query_index</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">index</span>
    <span class="n">query_text</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">query_text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="s2">&quot;No text found, please include a ?text=blah parameter in the URL&quot;</span><span class="p">,</span>
            <span class="mi">400</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">query_index</span><span class="p">(</span><span class="n">query_text</span><span class="p">)</span><span class="o">.</span><span class="n">_getvalue</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="p">),</span> <span class="mi">200</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;Hello World!&quot;</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5601</span><span class="p">)</span>
</code></pre></div>
<p><em>flask_demo.py</em></p>
<p>ä¸»è¦å˜åŒ–æ˜¯è¿æ¥åˆ°ç°æœ‰çš„ <code>BaseManager</code> æœåŠ¡å™¨å¹¶æ³¨å†Œå‡½æ•°ï¼Œä»¥åŠåœ¨ <code>/query</code> ç«¯ç‚¹é€šè¿‡ç®¡ç†å™¨è°ƒç”¨å‡½æ•°ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>BaseManager</code> æœåŠ¡å™¨è¿”å›çš„å¯¹è±¡ä¸æˆ‘ä»¬é¢„æœŸç•¥æœ‰ä¸åŒã€‚è¦è·å–åŸå§‹å¯¹è±¡ï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨ <code>_getvalue()</code> å‡½æ•°ã€‚</p>
<p>å¦‚æœå…è®¸ç”¨æˆ·ä¸Šä¼ æ–‡æ¡£ï¼Œæˆ‘ä»¬åº”è¯¥å…ˆåˆ é™¤æ–‡æ¡£æ–‡ä»¶å¤¹ä¸­çš„ Paul Graham æ–‡ç« ã€‚ç„¶åæ·»åŠ æ–‡ä»¶ä¸Šä¼ ç«¯ç‚¹ï¼é¦–å…ˆå®šä¹‰ Flask ç«¯ç‚¹å‡½æ•°ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="o">...</span>
<span class="n">manager</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;insert_into_index&quot;</span><span class="p">)</span>
<span class="o">...</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/uploadFile&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;POST&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">upload_file</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">manager</span>
    <span class="k">if</span> <span class="s2">&quot;file&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Please send a POST request with a file&quot;</span><span class="p">,</span> <span class="mi">400</span>

    <span class="n">filepath</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">uploaded_file</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">secure_filename</span><span class="p">(</span><span class="n">uploaded_file</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;documents&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="n">uploaded_file</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;filename_as_doc_id&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">manager</span><span class="o">.</span><span class="n">insert_into_index</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">doc_id</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">manager</span><span class="o">.</span><span class="n">insert_into_index</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># æ¸…ç†ä¸´æ—¶æ–‡ä»¶</span>
        <span class="k">if</span> <span class="n">filepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;Error: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)),</span> <span class="mi">500</span>

    <span class="c1"># æ¸…ç†ä¸´æ—¶æ–‡ä»¶</span>
    <span class="k">if</span> <span class="n">filepath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;File inserted!&quot;</span><span class="p">,</span> <span class="mi">200</span>
</code></pre></div>
<p>è¿˜ä¸é”™ï¼æˆ‘ä»¬å…ˆå°†æ–‡ä»¶å†™å…¥ç£ç›˜ã€‚å¦‚æœåªæ¥å— <code>txt</code> ç­‰ç®€å•æ ¼å¼å¯ä»¥è·³è¿‡è¿™æ­¥ï¼Œä½†å†™å…¥ç£ç›˜åå¯ä»¥åˆ©ç”¨ LlamaIndex çš„ <code>SimpleDirectoryReader</code> å¤„ç†æ›´å¤æ‚çš„æ–‡ä»¶æ ¼å¼ã€‚æˆ‘ä»¬è¿˜ä½¿ç”¨ç¬¬äºŒä¸ª <code>POST</code> å‚æ•°é€‰æ‹©æ˜¯å¦ä½¿ç”¨æ–‡ä»¶åä½œä¸º doc_idã€‚</p>
<p>å¯¹äºå¤æ‚è¯·æ±‚ï¼Œå»ºè®®ä½¿ç”¨ <a href="https://www.postman.com/downloads/?utm_source=postman-home">Postman</a>ã€‚æµ‹è¯•ç¤ºä¾‹è§<a href="https://github.com/logan-markewich/llama_index_starter_pack/tree/main/flask_react/postman_examples">é¡¹ç›®ä»“åº“</a>ã€‚</p>
<p>æœ€ååœ¨ <code>index_server.py</code> ä¸­å®ç°æ–°å‡½æ•°ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">insert_into_index</span><span class="p">(</span><span class="n">doc_text</span><span class="p">,</span> <span class="n">doc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">index</span>
    <span class="n">document</span> <span class="o">=</span> <span class="n">SimpleDirectoryReader</span><span class="p">(</span><span class="n">input_files</span><span class="o">=</span><span class="p">[</span><span class="n">doc_text</span><span class="p">])</span><span class="o">.</span><span class="n">load_data</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">doc_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">document</span><span class="o">.</span><span class="n">doc_id</span> <span class="o">=</span> <span class="n">doc_id</span>

    <span class="k">with</span> <span class="n">lock</span><span class="p">:</span>
        <span class="n">index</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
        <span class="n">index</span><span class="o">.</span><span class="n">storage_context</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>


<span class="o">...</span>
<span class="n">manager</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;insert_into_index&quot;</span><span class="p">,</span> <span class="n">insert_into_index</span><span class="p">)</span>
<span class="o">...</span>
</code></pre></div>
<p>å¾ˆç®€å•ï¼åŒæ—¶è¿è¡Œ <code>index_server.py</code> å’Œ <code>flask_demo.py</code>ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªèƒ½å¤„ç†å¤šè¯·æ±‚çš„ Flask API æœåŠ¡å™¨ï¼</p>
<p>ä¸ºäº†æ”¯æŒå‰ç«¯åŠŸèƒ½ï¼Œæˆ‘è°ƒæ•´äº†éƒ¨åˆ† API å“åº”æ ¼å¼ï¼Œå¹¶æ·»åŠ äº†è·Ÿè¸ªç´¢å¼•ä¸­æ–‡æ¡£çš„åŠŸèƒ½ï¼ˆLlamaIndex ç›®å‰å¯¹æ­¤æ”¯æŒæœ‰é™ï¼‰ã€‚æœ€åä½¿ç”¨ <code>Flask-cors</code> åŒ…æ·»åŠ äº† CORS æ”¯æŒã€‚</p>
<p>å®Œæ•´ä»£ç è§<a href="https://github.com/logan-markewich/llama_index_starter_pack/tree/main/flask_react">ä»“åº“</a>ï¼ŒåŒ…æ‹¬ <code>requirements.txt</code> å’Œç¤ºä¾‹ <code>Dockerfile</code>ã€‚</p>
<h2 id="react">React å‰ç«¯<a class="headerlink" href="#react" title="Permanent link">#</a></h2>
<p>React å’Œ TypeScript æ˜¯ç›®å‰æœ€æµè¡Œçš„å‰ç«¯å¼€å‘å·¥å…·ã€‚æœ¬æŒ‡å—å‡è®¾æ‚¨å·²ç†Ÿæ‚‰è¿™äº›å·¥å…·ã€‚</p>
<p>åœ¨<a href="https://github.com/logan-markewich/llama_index_starter_pack/tree/main/flask_react">ä»“åº“</a>ä¸­ï¼Œå‰ç«¯ä»£ç ä½äº <code>react_frontend</code> æ–‡ä»¶å¤¹ã€‚</p>
<p>æœ€æ ¸å¿ƒçš„éƒ¨åˆ†æ˜¯ <code>src/apis</code> æ–‡ä»¶å¤¹ï¼Œè¿™é‡ŒåŒ…å«å¯¹ Flask æœåŠ¡å™¨çš„è°ƒç”¨ï¼š</p>
<ul>
<li><code>/query</code> â€”â€” æŸ¥è¯¢ç°æœ‰ç´¢å¼•</li>
<li><code>/uploadFile</code> â€”â€” ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨å¹¶æ’å…¥ç´¢å¼•</li>
<li><code>/getDocuments</code> â€”â€” åˆ—å‡ºå½“å‰æ–‡æ¡£æ ‡é¢˜å’Œéƒ¨åˆ†å†…å®¹</li>
</ul>
<p>é€šè¿‡è¿™ä¸‰ä¸ªæ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªå¼ºå¤§çš„å‰ç«¯ï¼Œå…è®¸ç”¨æˆ·ä¸Šä¼ å’Œç®¡ç†æ–‡ä»¶ã€æŸ¥è¯¢ç´¢å¼•ï¼Œå¹¶æŸ¥çœ‹å“åº”å’Œæ¥æºæ–‡æœ¬ã€‚</p>
<h3 id="fetchdocumentstsx">fetchDocuments.tsx<a class="headerlink" href="#fetchdocumentstsx" title="Permanent link">#</a></h3>
<p>è¯¥æ–‡ä»¶åŒ…å«è·å–ç´¢å¼•ä¸­æ–‡æ¡£åˆ—è¡¨çš„å‡½æ•°ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">Document</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">fetchDocuments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Document</span><span class="p">[]</span><span class="o">&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;http://localhost:5601/getDocuments&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mode</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;cors&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">[];</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">documentList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">Document</span><span class="p">[];</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">documentList</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>
<p>æˆ‘ä»¬å‘ Flask æœåŠ¡å™¨ï¼ˆå‡è®¾è¿è¡Œåœ¨æœ¬åœ°ï¼‰å‘é€è¯·æ±‚ã€‚æ³¨æ„éœ€è¦åŒ…å« <code>mode: 'cors'</code> é€‰é¡¹ï¼Œå› ä¸ºè¿™æ˜¯è·¨åŸŸè¯·æ±‚ã€‚æ£€æŸ¥å“åº”çŠ¶æ€åï¼Œè¿”å›è§£æåçš„ JSON æ•°æ®ï¼ˆå³ <code>Document</code> å¯¹è±¡åˆ—è¡¨ï¼‰ã€‚</p>
<h3 id="queryindextsx">queryIndex.tsx<a class="headerlink" href="#queryindextsx" title="Permanent link">#</a></h3>
<p>è¯¥æ–‡ä»¶å°†ç”¨æˆ·æŸ¥è¯¢å‘é€è‡³ Flask æœåŠ¡å™¨ï¼Œå¹¶è·å–å“åº”ç»“æœä»¥åŠç´¢å¼•ä¸­æä¾›å“åº”çš„èŠ‚ç‚¹è¯¦æƒ…ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">ResponseSources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">doc_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">start</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">end</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">similarity</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="kr">type</span><span class="w"> </span><span class="nx">QueryResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">sources</span><span class="o">:</span><span class="w"> </span><span class="kt">ResponseSources</span><span class="p">[];</span>
<span class="p">};</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">queryIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">query</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">QueryResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">queryURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">URL</span><span class="p">(</span><span class="s2">&quot;http://localhost:5601/query?text=1&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="nx">queryURL</span><span class="p">.</span><span class="nx">searchParams</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">query</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="nx">queryURL</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">mode</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;cors&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">text</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Error in query&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">sources</span><span class="o">:</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">queryResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">QueryResponse</span><span class="p">;</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">queryResponse</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">queryIndex</span><span class="p">;</span>
</code></pre></div>
<p>è¿™ä¸ <code>fetchDocuments.tsx</code> æ–‡ä»¶ç±»ä¼¼ï¼Œä¸»è¦åŒºåˆ«åœ¨äºæˆ‘ä»¬å°†æŸ¥è¯¢æ–‡æœ¬ä½œä¸º URL å‚æ•°ä¼ é€’ã€‚éšåæ£€æŸ¥å“åº”çŠ¶æ€ï¼Œå¹¶è¿”å›å¸¦æœ‰æ­£ç¡® TypeScript ç±»å‹çš„å“åº”ç»“æœã€‚</p>
<h3 id="insertdocumenttsx">insertDocument.tsx<a class="headerlink" href="#insertdocumenttsx" title="Permanent link">#</a></h3>
<p>æœ€å¤æ‚çš„ API è°ƒç”¨å¯èƒ½è¦æ•°æ–‡æ¡£ä¸Šä¼ ã€‚æ­¤å‡½æ•°æ¥æ”¶æ–‡ä»¶å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨ <code>FormData</code> æ„å»º <code>POST</code> è¯·æ±‚ã€‚</p>
<p>è™½ç„¶å®é™…å“åº”æ–‡æœ¬æœªåœ¨åº”ç”¨ä¸­ä½¿ç”¨ï¼Œä½†å¯ç”¨äºå‘ç”¨æˆ·åé¦ˆæ–‡ä»¶æ˜¯å¦ä¸Šä¼ æˆåŠŸã€‚</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">insertDocument</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">file</span><span class="o">:</span><span class="w"> </span><span class="kt">File</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">formData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">FormData</span><span class="p">();</span>
<span class="w">  </span><span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;file&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">file</span><span class="p">);</span>
<span class="w">  </span><span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;filename_as_doc_id&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;http://localhost:5601/uploadFile&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mode</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;cors&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">formData</span><span class="p">,</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">responseText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">();</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nx">responseText</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">insertDocument</span><span class="p">;</span>
</code></pre></div>
<h3 id="_1">å…¶ä»–å‰ç«¯äº®ç‚¹<a class="headerlink" href="#_1" title="Permanent link">#</a></h3>
<p>è‡³æ­¤å‰ç«¯éƒ¨åˆ†å·²åŸºæœ¬å®Œæˆï¼å‰©ä½™çš„ React å‰ç«¯ä»£ç åŒ…å«ä¸€äº›åŸºç¡€ç»„ä»¶ï¼Œä»¥åŠæˆ‘è®©ç•Œé¢çœ‹èµ·æ¥è‡³å°‘è¿˜ç®—é¡ºçœ¼çš„å°è¯• :smile:ã€‚</p>
<p>å»ºè®®é˜…è¯»å®Œæ•´<a href="https://github.com/logan-markewich/llama_index_starter_pack/tree/main/flask_react/react_frontend">ä»£ç åº“</a>å¹¶æäº¤æ”¹è¿›çš„ PRï¼</p>
<h2 id="_2">ç»“è¯­<a class="headerlink" href="#_2" title="Permanent link">#</a></h2>
<p>æœ¬æŒ‡å—æ¶µç›–äº†æµ·é‡ä¿¡æ¯ã€‚æˆ‘ä»¬ä» Python ç¼–å†™çš„åŸºç¡€ Flask æœåŠ¡å™¨"Hello World"å¼€å§‹ï¼Œé€æ­¥æ„å»ºäº†åŠŸèƒ½å®Œæ•´çš„ LlamaIndex é©±åŠ¨åç«¯ï¼Œå¹¶å®ç°å…¶ä¸å‰ç«¯åº”ç”¨çš„è¿æ¥ã€‚</p>
<p>å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾æ‰©å±•å’Œå°è£… LlamaIndex æä¾›çš„æœåŠ¡ï¼ˆä¾‹å¦‚å¤–éƒ¨æ–‡æ¡£è¿½è¸ªå™¨ï¼‰ï¼Œä»è€Œä¸ºå‰ç«¯æä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p>
<p>åŸºäºæ­¤ï¼Œä½ å¯ä»¥æ·»åŠ è¯¸å¤šåŠŸèƒ½ï¼ˆå¤šç´¢å¼•/ç”¨æˆ·æ”¯æŒã€å°†å¯¹è±¡å­˜å‚¨è‡³ S3ã€æ¥å…¥ Pinecone å‘é‡æœåŠ¡å™¨ç­‰ï¼‰ã€‚è‹¥ä½ æ ¹æ®æœ¬æŒ‡å—æ„å»ºåº”ç”¨ï¼Œè¯·åŠ¡å¿…åœ¨ Discord ä¸­åˆ†äº«æˆæœï¼ç¥ä½ å¥½è¿ï¼ :muscle:</p>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
       
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../" class="md-footer__link md-footer__link--prev" aria-label="Previous: å®Œæ•´å®è·µæŒ‡å—">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                å®Œæ•´å®è·µæŒ‡å—
              </div>
            </div>
          </a>
        
        
          
          <a href="../fullstack_with_delphic/" class="md-footer__link md-footer__link--next" aria-label="Next: ä½¿ç”¨ Delphic æ„å»ºå…¨æ ˆ LlamaIndex Web åº”ç”¨çš„æŒ‡å—">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                ä½¿ç”¨ Delphic æ„å»ºå…¨æ ˆ LlamaIndex Web åº”ç”¨çš„æŒ‡å—
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <readthedocs-flyout position="bottom-left"></readthedocs-flyout>
      
    </div>
  </div>
</footer>
      
<!-- Google Tag Manager -->
<script>
  (function (w, d, s, l, i) {
    w[l] = w[l] || [];
    w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
    var f = d.getElementsByTagName(s)[0],
      j = d.createElement(s),
      dl = l != "dataLayer" ? "&l=" + l : "";
    j.async = true;
    j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
    f.parentNode.insertBefore(j, f);
  })(window, document, "script", "dataLayer", "GTM-WWRFB36R");
</script>
<!-- End Google Tag Manager -->

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.instant", "navigation.prune", "navigation.tabs", "navigation.indexes", "navigation.top", "navigation.footer", "toc.follow", "content.code.copy", "search.suggest", "search.highlight"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="../../../../javascript/runllm.js"></script>
      
        <script src="../../../../javascript/algolia.js"></script>
      
    
  </body>
</html>